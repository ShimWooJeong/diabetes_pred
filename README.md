# 발 열화상 이미지와 온도 데이터를 활용한 당뇨 예측 모델


## 프로젝트 목적 및 근거
해당 프로젝트는 열화상 이미지와 온도기록도를 기반으로 당뇨병을 예측하는 모델입니다. <br>
아래 저널에 근거해 열화상 이미지로 당뇨병을 예측하는 모델이 의미가 있다고 판단해 프로젝트를 진행했습니다:

- [열화상과 당뇨병의 관련성에 대한 저널](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2909517/)
- [당뇨병성 신경병증에서 열화상검사의 진단적 유용성에 대한 논문](https://www.e-agmr.org/upload/pdf/Kgs-004-01-07.pdf)

## 진행 과정

### 입력 데이터
- **대조군**: 비당뇨인 45명의 양 발에 대한 열화상 이미지 및 온도 기록도
- **실험군**: 당뇨인 122명의 양 발에 대한 열화상 이미지 및 온도 기록도

### 학습 모델
1. **온도기록도 데이터셋만 학습시킨 모델**: Logistic Regression & CNN
   - 온도기록도 단독으로 학습시켰을 때는 Logistic Regression으로 학습 정확도가 높았지만, Keras의 다중입력모델과 통합하기 어려워 단독으로 학습시킬 때는 Logistic Regression을 사용하고, 다중입력모델에서는 CNN을 사용해 학습시켰습니다.

2. **열화상 이미지 데이터셋만 학습시킨 모델**: CNN (Convolutional, Pooling, Flatten, Dense 레이어를 사용하여 구성)

3. **두 데이터셋 모두 학습시킨 모델**: Keras 기반 다중입력모델
   - 온도기록도와 이미지 데이터셋을 각각 CNN으로 모델을 구성한 후, 두 입력을 결합시켜 다중입력모델을 구성했습니다.

### 데이터 가공 과정

#### 이미지 데이터셋 가공
- 원본 이미지를 자르지 않기 위해 이미지 데이터셋 중 가장 큰 크기보다 약간 더 큰 88x200 크기로 리사이징했습니다.
- 이미지 본래의 해상도를 유지하기 위해 88x200 크기의 검정색 배경 이미지를 생성하고, 그 중앙에 원본 이미지를 배치해 처리했습니다.
- 학습시키려는 건 발 형태, 모양에 따른 학습이 아닌 온도 패턴에 따른 분류이므로 전체적인 발의 형태를 일치시키기 위해 모든 왼발 이미지를 flip으로 좌우 반전 처리해 동일화시켰습니다.
- 대조군과 실험군 모두 합쳐도 167명밖에 되지 않아서 데이터량이 부족하다고 판단해 Keras의 ImageDataGenerator를 사용해 이미지를 좌우이동, 회전하는 등 변형된 이미지를 생성했습니다.

#### 온도기록도 데이터셋 가공
- 이미지 데이터셋과 마찬가지로 양 발의 정확한 비교를 위해 csv파일을 데이터프레임으로 불러온 후, Numpy의 flip 함수를 사용해서 모든 왼발 온도기록도를 좌우반전 처리했습니다.
- 모든 발의 크기가 각기 다르기 때문에 행열의 크기도 모두 달라 전체가 0값인 200x100 크기의 배열을 생성한 후 원본 csv파일을 padding시켜 shape을 일치시켰습니다.
- 온도기록도 데이터셋은 행이나 열에 따로 레이블 정보를 포함한 인덱스가 없이 전체가 float값인 온도값만 있었기 때문에 Padding하는 과정에서 대조군 파일은 0, 실험군 파일은 1로 레이블을 지정했습니다.

## 학습 결과
![image](https://github.com/user-attachments/assets/b90cb7a1-945e-498e-bbdd-5460173fe1e7)

[데이터셋 출처: Plantar Thermogram Database for the Study of Diabetic Foot Complications](https://ieee-dataport.org/open-access/plantar-thermogram-database-study-diabetic-foot-complications)

